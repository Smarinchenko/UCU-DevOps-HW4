{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2024-12-04T19:27:42.318829Z", "invocation_id": "d4df9f46-cae6-4513-8e3e-1602a6b4e875", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:40.170933Z", "completed_at": "2024-12-04T19:27:42.039656Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.039986Z", "completed_at": "2024-12-04T19:27:42.040024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.012953042984009, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.metricflow_time_spine", "compiled": true, "compiled_code": "-- metricflow_time_spine.sql\nwith\n\ndays as (\n\n    --for BQ adapters use \"DATE('01/01/2000','mm/dd/yyyy')\"\n    \n    with date_spine as\n(\n\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 3651\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    \n\n    cast(cast(\n    cast(now() as timestamp)\n        at time zone 'UTC' at time zone 'America/Los_Angeles' as timestamp\n) as date) + ((interval '1 day') * (-3650))\n\n + ((interval '1 day') * ((row_number() over (order by 1) - 1)))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast(\n\n    cast(cast(\n    cast(now() as timestamp)\n        at time zone 'UTC' at time zone 'America/Los_Angeles' as timestamp\n) as date) + ((interval '1 day') * (1))\n\n as date)\n\n)\n\nselect * from filtered\n\n\n\n)\nselect\n    cast(d.date_day as timestamp) as date_day\nfrom\n    date_spine d\n\n\n\n),\n\ncast_to_date as (\n\n    select cast(date_day as date) as date_day\n\n    from days\n\n)\n\nselect * from cast_to_date", "relation_name": "\"postgres\".\"public\".\"metricflow_time_spine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.187278Z", "completed_at": "2024-12-04T19:27:42.193390Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.193952Z", "completed_at": "2024-12-04T19:27:42.193965Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007989168167114258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_customers", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"postgres\".\"public\".\"raw_customers\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        id as customer_id,\n\n        ---------- text\n        name as customer_name\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"postgres\".\"public\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.195942Z", "completed_at": "2024-12-04T19:27:42.200827Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.201064Z", "completed_at": "2024-12-04T19:27:42.201070Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006010293960571289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_locations", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"postgres\".\"public\".\"raw_stores\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        id as location_id,\n\n        ---------- text\n        name as location_name,\n\n        ---------- numerics\n        tax_rate,\n\n        ---------- timestamps\n        date_trunc('day', opened_at) as opened_date\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"postgres\".\"public\".\"stg_locations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.202424Z", "completed_at": "2024-12-04T19:27:42.204897Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.205101Z", "completed_at": "2024-12-04T19:27:42.205105Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0032749176025390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_order_items", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"postgres\".\"public\".\"raw_items\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        id as order_item_id,\n        order_id,\n        sku as product_id\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"postgres\".\"public\".\"stg_order_items\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.206164Z", "completed_at": "2024-12-04T19:27:42.210202Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.210405Z", "completed_at": "2024-12-04T19:27:42.210409Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004708051681518555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_orders", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"postgres\".\"public\".\"raw_orders\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        id as order_id,\n        store_id as location_id,\n        customer as customer_id,\n\n        ---------- numerics\n        subtotal as subtotal_cents,\n        tax_paid as tax_paid_cents,\n        order_total as order_total_cents,\n        (subtotal::numeric(16, 2) / 100) as subtotal,\n        (tax_paid::numeric(16, 2) / 100) as tax_paid,\n        (order_total::numeric(16, 2) / 100) as order_total,\n\n        ---------- timestamps\n        date_trunc('day', ordered_at) as ordered_at\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"postgres\".\"public\".\"stg_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.211480Z", "completed_at": "2024-12-04T19:27:42.214398Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.214583Z", "completed_at": "2024-12-04T19:27:42.214587Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036149024963378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_products", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"postgres\".\"public\".\"raw_products\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        sku as product_id,\n\n        ---------- text\n        name as product_name,\n        type as product_type,\n        description as product_description,\n\n\n        ---------- numerics\n        (price::numeric(16, 2) / 100) as product_price,\n\n        ---------- booleans\n        coalesce(type = 'jaffle', false) as is_food_item,\n\n        coalesce(type = 'beverage', false) as is_drink_item\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"postgres\".\"public\".\"stg_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.215497Z", "completed_at": "2024-12-04T19:27:42.223376Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.223549Z", "completed_at": "2024-12-04T19:27:42.223552Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008488893508911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.stg_supplies", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"postgres\".\"public\".\"raw_supplies\"\n\n),\n\nrenamed as (\n\n    select\n\n        ----------  ids\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(sku as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supply_uuid,\n        id as supply_id,\n        sku as product_id,\n\n        ---------- text\n        name as supply_name,\n\n        ---------- numerics\n        (cost::numeric(16, 2) / 100) as supply_cost,\n\n        ---------- booleans\n        perishable as is_perishable_supply\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"postgres\".\"public\".\"stg_supplies\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.224457Z", "completed_at": "2024-12-04T19:27:42.225395Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.225629Z", "completed_at": "2024-12-04T19:27:42.225632Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015578269958496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_customers", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.226454Z", "completed_at": "2024-12-04T19:27:42.227231Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.227383Z", "completed_at": "2024-12-04T19:27:42.227386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0012960433959960938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_items", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.228109Z", "completed_at": "2024-12-04T19:27:42.228872Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.229027Z", "completed_at": "2024-12-04T19:27:42.229029Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0012471675872802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_orders", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.229755Z", "completed_at": "2024-12-04T19:27:42.230506Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.230663Z", "completed_at": "2024-12-04T19:27:42.230666Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001238107681274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_products", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.231386Z", "completed_at": "2024-12-04T19:27:42.232182Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.232334Z", "completed_at": "2024-12-04T19:27:42.232336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0012760162353515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_stores", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.233030Z", "completed_at": "2024-12-04T19:27:42.233734Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.233873Z", "completed_at": "2024-12-04T19:27:42.233876Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0011510848999023438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jaffle_shop.raw_supplies", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.234566Z", "completed_at": "2024-12-04T19:27:42.241009Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.241152Z", "completed_at": "2024-12-04T19:27:42.241155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006907939910888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"postgres\".\"public\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.241867Z", "completed_at": "2024-12-04T19:27:42.244652Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.244791Z", "completed_at": "2024-12-04T19:27:42.244794Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0032682418823242188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.245496Z", "completed_at": "2024-12-04T19:27:42.246778Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.246907Z", "completed_at": "2024-12-04T19:27:42.246910Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017211437225341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.locations", "compiled": true, "compiled_code": "with\n\nlocations as (\n\n    select * from \"postgres\".\"public\".\"stg_locations\"\n\n)\n\nselect * from locations", "relation_name": "\"postgres\".\"public\".\"locations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.247556Z", "completed_at": "2024-12-04T19:27:42.249196Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.249325Z", "completed_at": "2024-12-04T19:27:42.249328Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020630359649658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom \"postgres\".\"public\".\"stg_locations\"\nwhere location_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.249963Z", "completed_at": "2024-12-04T19:27:42.251632Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.251758Z", "completed_at": "2024-12-04T19:27:42.251760Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002089977264404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    location_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"stg_locations\"\nwhere location_id is not null\ngroup by location_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.252424Z", "completed_at": "2024-12-04T19:27:42.253994Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.254125Z", "completed_at": "2024-12-04T19:27:42.254127Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020089149475097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"postgres\".\"public\".\"stg_order_items\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.254756Z", "completed_at": "2024-12-04T19:27:42.256306Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.256435Z", "completed_at": "2024-12-04T19:27:42.256437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019659996032714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_item_id\nfrom \"postgres\".\"public\".\"stg_order_items\"\nwhere order_item_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.257074Z", "completed_at": "2024-12-04T19:27:42.258622Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.258751Z", "completed_at": "2024-12-04T19:27:42.258754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001977205276489258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_item_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"stg_order_items\"\nwhere order_item_id is not null\ngroup by order_item_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.259395Z", "completed_at": "2024-12-04T19:27:42.263630Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.263761Z", "completed_at": "2024-12-04T19:27:42.263764Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004659891128540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"postgres\".\"public\".\"stg_orders\"\n\nwhere not(order_total - tax_paid = subtotal)\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.264391Z", "completed_at": "2024-12-04T19:27:42.265847Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.265968Z", "completed_at": "2024-12-04T19:27:42.265970Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018639564514160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"postgres\".\"public\".\"stg_orders\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.266578Z", "completed_at": "2024-12-04T19:27:42.269688Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.269810Z", "completed_at": "2024-12-04T19:27:42.269812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035169124603271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from \"postgres\".\"public\".\"stg_order_items\"\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from \"postgres\".\"public\".\"stg_orders\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.270405Z", "completed_at": "2024-12-04T19:27:42.271800Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.271913Z", "completed_at": "2024-12-04T19:27:42.271916Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017778873443603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"stg_orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.272485Z", "completed_at": "2024-12-04T19:27:42.273514Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.273623Z", "completed_at": "2024-12-04T19:27:42.273625Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0013937950134277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.products", "compiled": true, "compiled_code": "with\n\nproducts as (\n\n    select * from \"postgres\".\"public\".\"stg_products\"\n\n)\n\nselect * from products", "relation_name": "\"postgres\".\"public\".\"products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.274199Z", "completed_at": "2024-12-04T19:27:42.275612Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.275727Z", "completed_at": "2024-12-04T19:27:42.275729Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017971992492675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"postgres\".\"public\".\"stg_products\"\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.276301Z", "completed_at": "2024-12-04T19:27:42.277645Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.277757Z", "completed_at": "2024-12-04T19:27:42.277760Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017197132110595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_products_product_id.7d950a1467", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"stg_products\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.278324Z", "completed_at": "2024-12-04T19:27:42.279630Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.279744Z", "completed_at": "2024-12-04T19:27:42.279746Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016770362854003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.order_items", "compiled": true, "compiled_code": "with\n\norder_items as (\n\n    select * from \"postgres\".\"public\".\"stg_order_items\"\n\n),\n\n\norders as (\n\n    select * from \"postgres\".\"public\".\"stg_orders\"\n\n),\n\nproducts as (\n\n    select * from \"postgres\".\"public\".\"stg_products\"\n\n),\n\nsupplies as (\n\n    select * from \"postgres\".\"public\".\"stg_supplies\"\n\n),\n\norder_supplies_summary as (\n\n    select\n        product_id,\n\n        sum(supply_cost) as supply_cost\n\n    from supplies\n\n    group by 1\n\n),\n\njoined as (\n\n    select\n        order_items.*,\n\n        orders.ordered_at,\n\n        products.product_name,\n        products.product_price,\n        products.is_food_item,\n        products.is_drink_item,\n\n        order_supplies_summary.supply_cost\n\n    from order_items\n\n    left join orders on order_items.order_id = orders.order_id\n\n    left join products on order_items.product_id = products.product_id\n\n    left join order_supplies_summary\n        on order_items.product_id = order_supplies_summary.product_id\n\n)\n\nselect * from joined", "relation_name": "\"postgres\".\"public\".\"order_items\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.280365Z", "completed_at": "2024-12-04T19:27:42.281372Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.281492Z", "completed_at": "2024-12-04T19:27:42.281494Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0014019012451171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.supplies", "compiled": true, "compiled_code": "with\n\nsupplies as (\n\n    select * from \"postgres\".\"public\".\"stg_supplies\"\n\n)\n\nselect * from supplies", "relation_name": "\"postgres\".\"public\".\"supplies\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.282084Z", "completed_at": "2024-12-04T19:27:42.284211Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.284324Z", "completed_at": "2024-12-04T19:27:42.284327Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025081634521484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supply_uuid\nfrom \"postgres\".\"public\".\"stg_supplies\"\nwhere supply_uuid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.284891Z", "completed_at": "2024-12-04T19:27:42.286182Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.286296Z", "completed_at": "2024-12-04T19:27:42.286298Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016651153564453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    supply_uuid as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"stg_supplies\"\nwhere supply_uuid is not null\ngroup by supply_uuid\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.286858Z", "completed_at": "2024-12-04T19:27:42.288004Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.288119Z", "completed_at": "2024-12-04T19:27:42.288121Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015170574188232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.orders", "compiled": true, "compiled_code": "with\n\norders as (\n\n    select * from \"postgres\".\"public\".\"stg_orders\"\n\n),\n\norder_items as (\n\n    select * from \"postgres\".\"public\".\"order_items\"\n\n),\n\norder_items_summary as (\n\n    select\n        order_id,\n\n        sum(supply_cost) as order_cost,\n        sum(product_price) as order_items_subtotal,\n        count(order_item_id) as count_order_items,\n        sum(\n            case\n                when is_food_item then 1\n                else 0\n            end\n        ) as count_food_items,\n        sum(\n            case\n                when is_drink_item then 1\n                else 0\n            end\n        ) as count_drink_items\n\n    from order_items\n\n    group by 1\n\n),\n\ncompute_booleans as (\n\n    select\n        orders.*,\n\n        order_items_summary.order_cost,\n        order_items_summary.order_items_subtotal,\n        order_items_summary.count_food_items,\n        order_items_summary.count_drink_items,\n        order_items_summary.count_order_items,\n        order_items_summary.count_food_items > 0 as is_food_order,\n        order_items_summary.count_drink_items > 0 as is_drink_order\n\n    from orders\n\n    left join\n        order_items_summary\n        on orders.order_id = order_items_summary.order_id\n\n),\n\ncustomer_order_count as (\n\n    select\n        *,\n\n        row_number() over (\n            partition by customer_id\n            order by ordered_at asc\n        ) as customer_order_number\n\n    from compute_booleans\n\n)\n\nselect * from customer_order_count", "relation_name": "\"postgres\".\"public\".\"orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.288760Z", "completed_at": "2024-12-04T19:27:42.290126Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.290243Z", "completed_at": "2024-12-04T19:27:42.290245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017740726470947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_item_id\nfrom \"postgres\".\"public\".\"order_items\"\nwhere order_item_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.290811Z", "completed_at": "2024-12-04T19:27:42.292099Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.292206Z", "completed_at": "2024-12-04T19:27:42.292208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016529560089111328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_item_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"order_items\"\nwhere order_item_id is not null\ngroup by order_item_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.292733Z", "completed_at": "2024-12-04T19:27:42.293836Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.293943Z", "completed_at": "2024-12-04T19:27:42.293945Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001447916030883789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jaffle_shop.customers", "compiled": true, "compiled_code": "with\n\ncustomers as (\n\n    select * from \"postgres\".\"public\".\"stg_customers\"\n\n),\n\norders as (\n\n    select * from \"postgres\".\"public\".\"orders\"\n\n),\n\ncustomer_orders_summary as (\n\n    select\n        orders.customer_id,\n\n        count(distinct orders.order_id) as count_lifetime_orders,\n        count(distinct orders.order_id) > 1 as is_repeat_buyer,\n        min(orders.ordered_at) as first_ordered_at,\n        max(orders.ordered_at) as last_ordered_at,\n        sum(orders.subtotal) as lifetime_spend_pretax,\n        sum(orders.tax_paid) as lifetime_tax_paid,\n        sum(orders.order_total) as lifetime_spend\n\n    from orders\n\n    group by 1\n\n),\n\njoined as (\n\n    select\n        customers.*,\n\n        customer_orders_summary.count_lifetime_orders,\n        customer_orders_summary.first_ordered_at,\n        customer_orders_summary.last_ordered_at,\n        customer_orders_summary.lifetime_spend_pretax,\n        customer_orders_summary.lifetime_tax_paid,\n        customer_orders_summary.lifetime_spend,\n\n        case\n            when customer_orders_summary.is_repeat_buyer then 'returning'\n            else 'new'\n        end as customer_type\n\n    from customers\n\n    left join customer_orders_summary\n        on customers.customer_id = customer_orders_summary.customer_id\n\n)\n\nselect * from joined", "relation_name": "\"postgres\".\"public\".\"customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.294550Z", "completed_at": "2024-12-04T19:27:42.296139Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.296249Z", "completed_at": "2024-12-04T19:27:42.296251Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019850730895996094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"postgres\".\"public\".\"orders\"\n\nwhere not(order_items_subtotal = subtotal)\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.296797Z", "completed_at": "2024-12-04T19:27:42.298423Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.298537Z", "completed_at": "2024-12-04T19:27:42.298539Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001992940902709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"postgres\".\"public\".\"orders\"\n\nwhere not(order_total = subtotal + tax_paid)\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.299072Z", "completed_at": "2024-12-04T19:27:42.301068Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.301185Z", "completed_at": "2024-12-04T19:27:42.301187Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023632049560546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"postgres\".\"public\".\"orders\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.301756Z", "completed_at": "2024-12-04T19:27:42.303299Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.303409Z", "completed_at": "2024-12-04T19:27:42.303411Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019011497497558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from \"postgres\".\"public\".\"order_items\"\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from \"postgres\".\"public\".\"orders\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.303998Z", "completed_at": "2024-12-04T19:27:42.305942Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.306068Z", "completed_at": "2024-12-04T19:27:42.306070Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023751258850097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"postgres\".\"public\".\"orders\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"postgres\".\"public\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.306646Z", "completed_at": "2024-12-04T19:27:42.307997Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.308105Z", "completed_at": "2024-12-04T19:27:42.308107Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017137527465820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.308661Z", "completed_at": "2024-12-04T19:27:42.311516Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.311634Z", "completed_at": "2024-12-04T19:27:42.311636Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003229856491088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_type as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"public\".\"customers\"\n    group by customer_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'new','returning'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.312224Z", "completed_at": "2024-12-04T19:27:42.313956Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.314082Z", "completed_at": "2024-12-04T19:27:42.314084Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0021250247955322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"postgres\".\"public\".\"customers\"\n\nwhere not(lifetime_spend_pretax + lifetime_tax_paid = lifetime_spend)\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.314654Z", "completed_at": "2024-12-04T19:27:42.316014Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.316137Z", "completed_at": "2024-12-04T19:27:42.316139Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001741170883178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"postgres\".\"public\".\"customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T19:27:42.316688Z", "completed_at": "2024-12-04T19:27:42.318014Z"}, {"name": "execute", "started_at": "2024-12-04T19:27:42.318128Z", "completed_at": "2024-12-04T19:27:42.318130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016889572143554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 5.399634838104248, "args": {"require_resource_names_without_spaces": false, "select": [], "quiet": false, "exclude": [], "use_colors": true, "macro_debugging": false, "compile": true, "vars": {}, "write_json": true, "empty_catalog": false, "introspect": true, "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "cache_selected_only": false, "defer": false, "print": true, "log_level": "info", "log_level_file": "debug", "log_path": "/Users/mac/Desktop/UCU/DevOps/HW3/UCU-DevOps-HW4/logs", "profiles_dir": "/Users/mac/Desktop/UCU/DevOps/HW3/UCU-DevOps-HW4", "static": false, "indirect_selection": "eager", "which": "generate", "strict_mode": false, "use_colors_file": true, "invocation_command": "dbt docs generate", "enable_legacy_logger": false, "partial_parse": true, "populate_cache": true, "log_format_file": "debug", "project_dir": "/Users/mac/Desktop/UCU/DevOps/HW3/UCU-DevOps-HW4", "static_parser": true, "send_anonymous_usage_stats": true, "log_format": "default", "show_resource_report": false, "version_check": true, "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "source_freshness_run_project_hooks": false, "require_explicit_package_overrides_for_builtin_materializations": true, "favor_state": false}}